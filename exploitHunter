//Version 1.1

metaxploit=include_lib("/lib/metaxploit.so")
if params.len > 2 or params.len < 1 or params[0] == "-h" or params[0] == "--help" then 
	exit("<b>Usage: "+program_path.split("/")[-1]+" [ip_address] [opt: port]</b>")
else if params.len == 2 then
	net_session = metaxploit.net_use(params[0],params[1].val) //net session targetting port
else
	net_session = metaxploit.net_use(params[0]) //net session targetting router
end if


//Finds and prints all memAddresses and the associtated unsecValues to exploit them to the terminal
find_vulnerable=function()
	report = {}
	metalib = net_session.dump_lib
	addresses = metaxploit.scan(metalib) //get memory addresses
	for address in addresses
		report[address] = metaxploit.scan_address(metalib, address)
	end for
	print(report)
end function
	
find_vulnerable()
